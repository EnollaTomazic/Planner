# Repository Guidelines

This file defines expectations for the entire repository. Check for nested `AGENTS.md` files when working in subdirectories.

## Setup
- Install dependencies with `pnpm install`.
- Start local development with `pnpm run dev`. The script runs `pnpm run prebuild` first so the autogenerated UI index stays current.
- See [README.md#getting-started](README.md#getting-started) for OS prerequisites and additional context.

## Scripts
- Keep the UI component barrel up to date with `pnpm run regen-ui`. The command is invoked automatically during `pnpm install`, `pnpm run dev`, and `pnpm run build`, but rerun it manually after adding, removing, or renaming UI components.
- `pnpm run regen-feature` updates feature scaffolding. Execute it after changing feature modules so the generated exports stay synchronized.
- Build-time helpers such as `pnpm run generate-tokens`, `pnpm run generate-themes`, and `pnpm run build-gallery-usage` are available for design token pipelines—consult the relevant scripts before modifying token-related assets.
- The GitHub Pages workflow uses `pnpm run deploy` (an alias for `pnpm run deploy:pages`). Review [README.md#github-pages-deployment](README.md#github-pages-deployment) for required environment variables and branch configuration.

## Testing & Quality Gates
- Run `pnpm run check` before committing. It launches unit tests, linting, design lint, type checking, and the artifact guard in parallel.
- Execute `pnpm run verify-prompts` when modifying prompt definitions or AI-related flows.
- Use targeted scripts when needed: `pnpm test`, `pnpm run lint`, `pnpm run lint:design`, `pnpm run typecheck`, and `pnpm run guard:artifacts`.

## Build & Deploy
- Perform production builds with `pnpm run build`.
- For bundle analysis, run `pnpm run analyze`, which wraps the build in analyzer tooling and copies reports to `docs/bundle-report/`.
- Deploy static exports to GitHub Pages using `pnpm run deploy`. Follow the guidance in [README.md#github-pages-deployment](README.md#github-pages-deployment) to configure `BASE_PATH`, `GITHUB_PAGES`, and authentication variables when pushing from CI.

## Environment Variables
- Copy `.env.example` to `.env.local` for local work. Keep `.env.local` untracked.
- Reference [README.md#configuration-reference](README.md#configuration-reference) for the full list of supported variables, defaults, and their effects.
- When replicating the GitHub Pages environment locally, set `GITHUB_PAGES=true` and align `BASE_PATH`/`NEXT_PUBLIC_BASE_PATH` as described in [README.md#github-pages-deployment](README.md#github-pages-deployment).

## Code Style & Conventions
- Maintain strict TypeScript settings—do not relax `tsconfig.json` (the project uses strict type checking throughout).
- Prefer modern TypeScript/React patterns and reuse primitives documented in [docs/design-system.md](docs/design-system.md).
- Format code with single quotes for strings, avoid semicolons, and keep trailing commas where valid. Configure ESLint/Prettier changes accordingly if you introduce new files.
- Use 2-space indentation and keep imports organized (group external dependencies before local modules).
- Add new UI primitives to the prompts page (`src/app/prompts/page.tsx`) so the gallery remains comprehensive.

## Housekeeping
- Clean tsx caches with `pnpm run clean:artifacts` when `pnpm run guard:artifacts` reports stale `node-compile-cache` or `tsx-*` directories.
- Consult [CONTRIBUTING.md](CONTRIBUTING.md) for contribution etiquette and broader project context.
